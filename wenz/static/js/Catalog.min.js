var catalog={autoLoadCatEntries:false,currentRequest:null,facetHasChanged:false,browsingMode:"scroll",preloadOffset:700,isMoreJS:false,bareBones:false,usedAjaxUrls:[],$window:$(window),scrollEvent:function(){if(!catalog.autoLoadCatEntries){$("#loadingIndicator").ifExists(function(){if($("#loadingIndicator").offset()){if(catalog.bareBones){if($(".productBox.bareBones").length>0){var e=catalog.preloadOffset+200;var t=catalog.$window.height();var i=catalog.$window.scrollTop();if($(".productBox.bareBones").length>0){var a=$(".productBox.bareBones").first().offset().top;var r=t+i;var l=catalog.preloadOffset+300;if(a-e<=r){catalog.lazyLoad(true)}}}}else if(catalog.$window.scrollTop()+catalog.$window.height()+catalog.preloadOffset>=$("#loadingIndicator").offset().top){catalog.lazyLoad()}}})}$("#catalogEntryGrid").ifExists(function(){var e=$("#catalogEntryGrid").offset().top+3*$(".productBoxContainer").height()-catalog.$window.height();if(window.matchMedia("(max-width: 766px)").matches&&$("#backToTopContainer").offset().top>=getTop()){e=getTop()}if(catalog.$window.scrollTop()>e){$("#backToTopContainer:hidden").fadeIn(200)}})},toggleFacet:function(e,t,i,a){if(i){this.appendFacet(e,t,a)}else{this.removeFacet(e,t,a)}},addFacets:function(e,t){$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},toggleColorFacet:function(e,t,i){var a=getElementByEvent(i);var r=false;var l=$("#facet-checkbox"+e);if(l.prop("checked")){l.prop("checked",false);$("#facet-color"+e).toggleClass("selected",false);var o=$(".facet-color"+e);o.find("input").prop("checked",false);o.toggleClass("selected",false)}else{l.prop("checked",true);$("#facet-color"+e).toggleClass("selected",true)}if(typeof a!=="undefined"){r=a.className.indexOf("colorName")>=0}if(t!="HappySizeMore"||t=="HappySizeMore"&&r){$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")}},toggleTileClass:function(e){$filter=$("#available-size-filters .facetContainer-size"+e);$inputInAvailableFilters=$filter.children("#facet-size"+e);$filterInSelection=$(".facetContainer-size"+e);$inputInSelectedFilters=$filterInSelection.children("#facet-size"+e);if($filter.hasClass("selected")){$inputInAvailableFilters.prop("checked",false);$inputInSelectedFilters.prop("checked",false);$filter.removeClass("selected")}else{$inputInAvailableFilters.prop("checked",$inputInAvailableFilters.prop("checked")==true?false:true);$inputInSelectedFilters.prop("checked",$inputInSelectedFilters.prop("checked")==true?false:true);$filter.toggleClass("marked")}},setCategoryFacet:function(e){$("#categoryFilterValue").val(e);$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},priceFacet:function(){$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},priceRangeFacet:function(e,t){var i=$("."+t).attr("name");var a=$("."+t).val();$(e).addClass("selected");var r=$("#"+t+"-min");var l=$("#"+t+"-max");var o=$("#priceRangeFrom");var n=$("#priceRangeTo");if(r.length>0&&o.length>0){o.val(r.val())}if(l.length>0&&n.length>0){n.val(l.val())}},clearPriceRange:function(e,t){t=t||window.event;var i=$(e);if(i.children("#onlySaleCheckbox-selected").length>0){$("#onlySaleCheckbox").attr("checked",false);$("#onlySaleCheckbox-selected").attr("checked",false)}else{var a=$("#priceRangeFrom");var r=$("#priceRangeTo");$("#priceRangeFrom").val("");$("#priceRangeTo").val("")}$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},appendFacet:function(e,t){$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},removeFacet:function(e,t,i){if(typeof i==="undefined"){i=true}$("#available-"+e+"-filters .facetContainer-"+e+t).parent().removeClass("selected");$(".selected-"+e+"-filters .facetContainer-"+e+t).remove();$("#available-"+e+"-filters #facet-"+e+t).prop("checked",false);if(e==="brand"){$("#additional-brands #facet-"+e+t).prop("checked",false)}if(i){$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")}},removeFacetDesktopFilter:function(e,t,i){if(typeof i==="undefined"){i=true}$(".facetContainer-"+e+t).parent().removeClass("selected");$("#facet-"+e+t).prop("checked",false);if(i){$(".facetContainer-"+e+t).remove();$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")}},removeFacetHappySizeMore:function(e,t,i){var a=$(getElementByEvent(i));var r=a.parent().parent().hasClass("selectedFilterContainer");var l=a.parent().parent();if(r){$("#available-"+e+"-filters .facetContainer-"+e+t).parent().removeClass("selected");$(".selected-"+e+"-filters .facetContainer-"+e+t).remove();$("#available-"+e+"-filters #facet-"+e+t).prop("checked",false);$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")}else if($("html").hasClass("lt-ie9")){this.toggleTileClass(t)}},clearFilter:function(e){if(!$("#available-"+e+"-filters input:checked").length)return;$("#available-"+e+"-filters input").prop("checked",false);$(".selected-"+e+"-filters").html("");$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},clearColorFilter:function(e){if(!$("#available-color-filters input:checked").length)return;$("#available-color-filters input").prop("checked",false);$("#available-color-filters .color").toggleClass("selected",false);$(".selected-color-filters input").prop("checked",false);$(".selected-color-filters .color").toggleClass("selected",false);if(e)$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},clearCategoryFilter:function(){$("#categoryFilterValue").val("");$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},clearAllFilters:function(){this.clearAllFiltersOnly();$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},clearAllFiltersOnly:function(){this.clearColorFilter(false);$(".selectedFiltersContainer").html("");$(".facetCheckbox").prop("checked",false);$(".priceFilterSet").val("false");$("#priceRangeFrom").val(priceFilterMinDefault);$("#priceRangeTo").val(priceFilterMaxDefault);$("#priceFilterContainer input").each(function(){if($(this).is(":radio")||$(this).is(":checkbox")){$(this).removeAttr("checked")}})},updateFilters:function(){for(i=0;i<facetIDs.length;i++){if(facetIDs[i]=="shoesWide"){facetIDs.push("ads_f11031_ntk_cs")}if(facetIDs[i]==="color"){var e=$("#available-"+facetIDs[i]+"-filters input:checked").parent().parent().parent().clone();e.find("input").attr("name","");e.appendTo(".selected-"+facetIDs[i]+"-filters")}else{var t;if(facetIDs[i]!=="brand"){t=$("#available-"+facetIDs[i]+"-filters input:checked")}else{t=$("#available-"+facetIDs[i]+"-filters").parent().find("input:checked")}var a=$(".selected-"+facetIDs[i]+"-filters");$clone=t.parent().clone();$clone.find("input").attr("name","");a.html($clone);if((t.is(":radio")||t.is(":checkbox"))&&facetIDs[i]==="price"){a.children("div").addClass("selected");a.children("div").attr("onclick","catalog.clearPriceRange(this, event);");a.children().children("label").each(function(){$(this).attr("for",$(this).attr("for")+"-selected")});a.children().children("input").each(function(){var e=$(this).attr("id");var t=$(this).attr("name");if(e!==undefined){$(this).attr("id",$(this).attr("id")+"-selected")}if(t!==undefined&&t!==""){$(this).attr("name",$(this).attr("name")+"-selected")}else{$(this).attr("name",$(this).attr("id"))}});if(t.is(":radio")){t.attr("checked","true")}}}}},changeCounter:0,facetChanged:function(){if(typeof catalog.currentRequest!=="undefined"&&catalog.currentRequest){catalog.currentRequest.abort()}catalogAjaxURL=null;$("#catalogEntryGrid").html("");showLoadIndicator();catalog.checkFacetLabels();catalog.changeCounter=catalog.changeCounter+1;var e=catalog.changeCounter;if($(".priceRangeTo").val()<priceFilterMaxDefault||$(".priceRangeFrom").val()>priceFilterMinDefault){$(".priceFilterSet").val("true")}setTimeout(function(){if(e===catalog.changeCounter){$("#categoryFacetForm").submit()}},1e3)},checkFacetLabels:function(){filterActive=false;for(i=0;i<facetIDs.length;i++){selectedFilters=$(".selected-"+facetIDs[i]+"-filters");if(selectedFilters.length&&selectedFilters.html().length){filterActive=true;$("#"+facetIDs[i]+"-filter-label").show()}else{$("#"+facetIDs[i]+"-filter-label").hide()}}if(filterActive){$("#allSelectedFiltersHeader").show()}else{$("#allSelectedFiltersHeader").hide()}$(".filterContainer").each(function(e,t){if($(t).children(".selectedFiltersContainer").find("div").length>=1){$(t).find(".selectedFilterLabel").show()}else{$(t).find(".selectedFilterLabel").hide()}})},lazyLoad:function(e){var e=e?e:false;if(!$.active){if(typeof catalogAjaxURL!=="undefined"&&catalogAjaxURL){if(e){var t=this.getPreparedCatalogAjaxUrl(catalogAjaxURL);if(catalog.usedAjaxUrls.indexOf(t)<0){this.loadCategoryEntries(t,true)}}else{var t=this.getPreparedCatalogAjaxUrl(catalogAjaxURL);if(catalog.browsingMode==="scroll"){$("#footer").css("visibility","hidden");$("#historyRecoTop").css("visibility","hidden")}this.loadCategory(t,true)}}else{hideLoadIndicator("catalogLoadingIndicator");$("#footer").css("visibility","visible");$("#historyRecoTop").css("visibility","visible");updateBackToTop()}}},imgLazyLoad:function(){$("img.lazyLoad").lazyload({threshold:150,effect:"fadeIn"})},getPreparedCatalogAjaxUrl:function(e){var t=new Url(e);if(typeof t.query.initPageSize!=="undefined"){t.query.beginIndex=t.query.pageSize;t.query.pageSize=t.query.initPageSize}return t.toString()},loadCategory:function(e,t){if(typeof this.currentRequest!="undefined"&&this.currentRequest){this.currentRequest.abort()}e=stripProtocol(e);if(!t&&catalog.browsingMode=="scroll"){$("#catalogEntryGrid").html("");showLoadIndicator("catalogLoadingIndicator")}this.currentRequest=$.post(e,function(e){$(e).appendTo("#catalogEntryGrid");catalog.imgLazyLoad();if(checkDevice.isMobile()){catalog.applyTouchFunctions()}if(this.autoLoadCatEntries){this.lazyLoad()}else{catalog.$window.scroll();updateBackToTop()}$(kmo_wcs_pb$.eventBus).trigger("catalog.loaded");hideLoadIndicator("catalogLoadingIndicator")}).always(function(){if(catalog.isMoreJS&&typeof MoreJS.showMoreColors=="function"){MoreJS.showMoreColors()}})},loadCategoryEntries:function(e,t){if(typeof this.currentRequest!="undefined"&&this.currentRequest){this.currentRequest.abort()}e=stripProtocol(e);this.currentRequest=$.post(e,function(t){catalog.usedAjaxUrls.push(e);var i=$(t);i.each(function(){var e=$(this);if(e.hasClass("productBoxContainer")){var t=e.prop("id");if(typeof t!=="undefined"){$("#"+t).empty().append(e.html())}}else if(e.attr("id")==="CatalogAjaxURL"){var i=e.data("url");if(catalog.usedAjaxUrls.indexOf(i)<0){catalogAjaxURL=i}}else if(e.prop("tagName")==="SCRIPT"){e.appendTo($("body"))}});$(kmo_wcs_pb$.eventBus).trigger("catalog.loaded");catalog.imgLazyLoad()}).always(function(){if(catalog.isMoreJS&&typeof MoreJS.showMoreColors=="function"){MoreJS.showMoreColors()}})},loadMoreCategoryEntries:function(){showLoadIndicator("catalogLoadingIndicator");$(".loadMoreCatEntriesContainer").addClass("hideBanner");catalog.lazyLoad()},filterSlideToggle:function(e){e.prev().children(".filterHeader").toggleClass("closed");e.toggleClass("closed")},toggleStandardFilter:function(){if($("#additionalFilterContainer").hasClass("closed")){$(".allAdditionalFiltersToggle .lessFilterLabel").css("display","none");$(".allAdditionalFiltersToggle .moreFiltersLabel").css("display","block");docCookies.setItem("filterCookieMore",0)}else{$(".allAdditionalFiltersToggle .lessFilterLabel").css("display","block");$(".allAdditionalFiltersToggle .moreFiltersLabel").css("display","none");docCookies.setItem("filterCookieMore",1)}if(window.matchMedia("(max-width: 1023px)").matches){$("#categoryFacetForm > .filterHeaderContainer").toggleClass("show");if($("#categoryFacetForm > .filterHeaderContainer")[0]!=null){$($("#categoryFacetForm > .filterHeaderContainer")[0]).addClass("firstFilter")}}},hoverColor:function(e,t){var i=$("#productSizes-"+e);var a=$("#productBox-"+e);a.addClass("hasHover");a.find(".categoryAvailabilityHover, .categoryProductAttributeContainer").off("mouseleave").on("mouseleave",function(){a.removeClass("hasHover");a.find(".categoryAvailabilityHover,  .categoryProductColors").off("mouseleave")});if(i.data("color")===t){return}else{$("#productSizes-"+e).html('<div class="loadingIndicator"><img src="'+kmo_wcs_pb$.getImgDir()+'ajax-loader.gif" alt="'+labels.loadingIconAlt+'"></div>');var r={};r.storeId=kmo_wcs_pb$.getStoreId();r.langId=kmo_wcs_pb$.getLangId();r.catalogId=kmo_wcs_pb$.getCatalogId();r.productId=e;r.colorId=t;if(typeof kmo_wcs_pb$.getCategoryId!="undefined"){r.categoryId=kmo_wcs_pb$.getCategoryId()}r.onlyCatalogEntryPrice="true";$.post("AjaxProductSizes",r,function(e){i.html(e);i.data("color",t);i.parents(".categoryAvailabilityHover").hide().show(0);i.parents(".categoryAvailabilityHover").attr("style","")})}},toggleColorBlock:function(e){$(e).parents(".categoryProductAttributeContainer").children(".categoryProductColors").removeClass("colorsOverflow");$(e).parents(".linkForColorOverflow").hide()},togglefilterexpanded:function(e){var t=$("#additional-"+e);t.toggle();if(t.parent().find(".expand").hasClass("not")){t.parent().find(".unexpand").addClass("not");t.parent().find(".expand").removeClass("not")}else if(t.parent().find(".unexpand").hasClass("not")){t.parent().find(".expand").addClass("not");t.parent().find(".unexpand").removeClass("not")}},initializeSlider:function(e){if(typeof e==="undefined"){e="#priceFilterContainer"}var t=$(e);if(!t.find("#priceFilter").length){return}var i=t.find(".priceRangeFrom");var a=t.find(".priceRangeTo");var r=i.val();if(!(r&&r!="*"))r=priceFilterMinDefault;var l=a.val();if(!(l&&l!="*"))l=priceFilterMaxDefault;var o=function(){if($(".priceRangeTo").val()<priceFilterMaxDefault||$(".priceRangeFrom").val()>priceFilterMinDefault){$(".priceFilterSet").val("true")}};i.on("change",o);a.on("change",o);$(kmo_wcs_pb$.eventBus).on("slider.finish",o);return t.children(".slider").noUiSlider({range:[priceFilterMinDefault,priceFilterMaxDefault],start:[r,l],connect:true,serialization:{to:[i,a],resolution:1,mark:","}})},orderBy:function(e,t){$("#"+e+' [name="orderBy"]').val(t);catalog.facetChanged()},synchronizeCatalogEspots:function(){$(".catalogListingESpot").each(function(){var e=$(this);$("#placeForEspotOnCategoryPage_"+e.data("index")).appendTo(e)})},applyTouchFunctions:function(){$("#catalogEntryGrid").find(".quickViewLink").css("display","none");$(".productBoxImage").off("touchend").on("touchend",function(){$(this).children(".catEntryDisplayLink").trigger("click")})},defineEvents:function(){var e="";var t=$("#categoryFacetForm");$links=t.find("a[data-click]");$links.each(function(){var t=$(this);t.click(function(i){var a=t.attr("data-click").split(";");for(var r=0;r<a.length;r++){var l=$.trim(a[r]);if(l.length>0){e=a[r];var o=new Function(e);try{o()}catch(n){if(window.console){console.log(n)}}}}})})}};function initializeCategoryPage(){if($("#priceFilterContainerDesktop").length>0){catalog.initializeSlider("#priceFilterContainerDesktop")}catalog.isMoreJS=typeof MoreJS!="undefined";catalog.bareBones=function(){if(typeof kmo_wcs_pb$.getBareBones!=="undefined"&&kmo_wcs_pb$.getBareBones()===true){return true}else{return false}}();if(catalog.isMoreJS){catalog.browsingMode="click";hideLoadIndicator("catalogLoadingIndicator")}if($(".productBox").length&&catalog.browsingMode=="scroll"){if(!catalog.bareBones){$("#footer").css("visibility","hidden");$("#historyRecoTop").css("visibility","hidden")}else{hideLoadIndicator("catalogLoadingIndicator")}}catalog.initializeSlider();if(catalog.browsingMode=="scroll"){catalog.$window.scroll(function(){catalog.scrollEvent();updateBackToTop()})}else{catalog.$window.scroll(updateBackToTop)}if(checkDevice.isMobile()){catalog.applyTouchFunctions()}removeSEOLinks(".facetLink");catalog.$window.resize(updateBackToTop,"resize",100);catalog.imgLazyLoad();$("#available-color-filters .colorTile").bind({mouseleave:function(){$("#color-filter-preview").html("")},mouseenter:function(){$(this).clone().appendTo("#color-filter-preview");$("#color-filter-preview").append($(this).children(".color").attr("title"))}});if(catalog.autoLoadCatEntries){catalog.lazyLoad()}else{catalog.$window.scroll()}catalog.updateFilters();if($("#allSelectedFilters .selectedFilterContainer").children().length){$("#allSelectedFiltersHeader").show()}else{$("#allSelectedFiltersHeader").hide()}catalog.checkFacetLabels();$("#mainContent").on("appear","img.lazyLoad",function(){$(this).removeClass("lazyLoad")});if(!catalog.isMoreJS&&kmo_wcs_pb$.getFilterLayout()!=="MobileLight"&&$(".catalogSection .categoryGridHeaderContainer").length>0){$("body").off("click",".sideNavFilterContainer  .filterInputContainer").on("click",".sideNavFilterContainer .filterInputContainer",function(){$("html, body").animate({scrollTop:$(".catalogSection .categoryGridHeaderContainer").offset().top+"px"},500)});catalog.scrollEvent()}if($("#additionalFilterContainer").length>0){$("#additionalFilterContainer").find(".filterContainer").each(function(){$(this).addClass("closed")})}var e=$("#priceFilterContainer");if(e.length>0){var t=$("#priceRangeFrom");var i=$("#priceRangeTo");if(catalog.isMoreJS){if(t.length>0){t.bind("keyup",function(){MoreJS.toggleFilterBtn("#"+e.attr("id"))})}if(i.length>0){i.bind("keyup",function(){MoreJS.toggleFilterBtn("#"+e.attr("id"))})}}}catalog.defineEvents();catalog.synchronizeCatalogEspots();$(kmo_wcs_pb$.eventBus).on("catalog.loaded",catalog.synchronizeCatalogEspots);$(kmo_wcs_pb$.eventBus).on("catalog.facetChanged",catalog.facetChanged);$(kmo_wcs_pb$.eventBus).trigger("catalog.initialized")}$(document).safeReady(initializeCategoryPage);$(document).safeReady(function(){var e=function(){var e='<div class="mobileFilterPopup">'+"<div id=\"mobileFilterCloseButton\" onclick=\"$('.mobileFilterPopup').foundation('reveal', 'close');\"></div>"+'<div id="mobileFilterContent"></div>'+'<div class="secondaryButton"><div class="buttonText">'+labels.mobileFilterClose+"</div></div>"+'<div class="primaryButton"><div class="buttonText">'+labels.mobileFilterApply+"</div></div>"+"</div>";var t;var a;var r=$("#priceRangeTo").val();var l=$("#priceRangeFrom").val();var o=$("#categoryFacetForm").serialize();var n=[];var c=false;if($("#topFilterFlag").val()=="topFilterTrue"){c=true}var s={filterCount:7,hideCategoryFilterInLeaf:false};var d=function(e){var t,i;$target=$(e.target),noFilterActive=true;if($target.hasClass("tileGradient")){noFilterActive=false;t=$("#topFilter_color").find(".primaryButton");i=$("#topFilter_color").find(".secondaryButton")}else{var a=$target.closest(".filterInputContainer");if(a.length===0){a=$target.closest(".filterInputContainerMiddle")}var r=a.find("input").first();if(r.is(":checked")){r.prop("checked",false)}else{r.prop("checked",true)}var l=a.closest(".filterContent");t=l.parent().find(".primaryButton");i=l.parent().find(".secondaryButton");if(l.parent().attr("id")!="topFilter_price"){l.find("input").each(function(){if($(this).is(":checked")){noFilterActive=false;return false}})}}if(noFilterActive&&$(".hasFilter").length===0){t.hide();i.show()}if(o===$("#categoryFacetForm").serialize()){t.hide();i.show()}else{t.show();i.hide()}if($target.closest(".topFilterBox").attr("id")!="topFilter_price"){setTimeout(function(){$("#categoryFacetForm").trigger("change")},50)}};var f={$priceFilterContainer:$("#priceFilterContainer"),$desktopFilters:$("#desktopFilters"),init:function(){f.$priceFilterContainer.ifExists(function(){$("#desktopFilters").on("input","#priceRangeFrom",function(){f.verifyChanges();f.syncBeforeSubmit()}).on("input","#priceRangeTo",function(){f.verifyChanges();f.syncBeforeSubmit()}).on("click mouseup touchend",".noUi-handle",function(){f.verifyChanges()}).on("click mouseup touchend",".noUi-origin",function(){f.verifyChanges()});$(kmo_wcs_pb$.eventBus).on("slider.finish",function(){f.verifyChanges();f.syncBeforeSubmit()})})},syncBeforeSubmit:function(){f.$priceFilterContainer.find("#priceRangeFrom").val(f.$desktopFilters.find("#priceRangeFrom").val());f.$priceFilterContainer.find("#priceRangeTo").val(f.$desktopFilters.find("#priceRangeTo").val())},initSlider:function(){var e=f.$desktopFilters.find("#priceFilterContainerDesktop");e.find(".priceFilterButton").remove();e.find(".noUi-base").remove();catalog.initializeSlider(e)},verifyChanges:function(){var e=false;if(r!=f.$desktopFilters.find("#priceRangeTo").val()||l!=f.$desktopFilters.find("#priceRangeFrom").val()){e=true}if(e){$("#topFilter_price").find(".primaryButton").show();$("#topFilter_price").find(".secondaryButton").hide();$(".priceFilterSet").val("true")}else{$("#topFilter_price").find(".primaryButton").hide();$("#topFilter_price").find(".secondaryButton").show()}}};var p=function(t){var i=$(t.target).parent();var a=i.data("filterid");var r=false;var l=$("#"+a+"FilterContainer");var o=function(){var e=true;var t=$(".mobileFilterPopup");var a=t.find(".primaryButton");var r=t.find(".secondaryButton");t.addClass("filterChanged");if(i.data("filterid")!="price"){var l;if(i.data("filterid")=="color"){l=t.find(".colorTile")}else{l=t.find(".filterInputContainer, .filterInputContainerMiddle")}l.each(function(){var t=$(this).find("label").first();if($(this).find("input").first().is(":checked")){e=false;t.addClass("activeFilterItem");t.removeClass("inActiveFilterItem")}else{t.addClass("inActiveFilterItem");t.removeClass("activeFilterItem")}});if(e){a.hide();r.show()}else{r.hide();a.show()}}};var n;if(a==="size"){n=$("<div></div>");n.html(l.find("#visible-sizes").html());if(l.find("#additional-sizes").length>0){n.html(l.find("#visible-sizes").html()+l.find("#additional-sizes").html())}}else if(a==="price"){n=$("<div></div>");n.html($("#priceFilterContainer").clone(false));n.find(".slider").html("");var c=catalog.initializeSlider(n.children());c.on("change",o)}else if(a==="color"){r=true;n=$("#available-color-filters").clone();n.find(".color").attr("onclick",null).off("click").on("click",function(){var e=$(this);var t=e.find("input");if(t.is(":checked")){e.addClass("selected")}else{e.removeClass("selected")}t.trigger("click");$("#"+t.data("oldid")).attr("checked",t.is(":checked"))});n.find("input").data("color",true)}else if(a==="brand"){n=$("#available-brand-filters").clone();if(l.find("#additional-brands").length>0){n.html(l.find("#available-brand-filters").html()+l.find("#additional-brands").html())}}else{n=l.find(".availableFilters").clone()}n.find("input").each(function(){var e=$(this);e.off("change").on("change",o);e.data("oldid",e.attr("id"));var t=e.attr("id")+"mobile";e.attr("id",t);e.parent().children("label").attr("for",t)});var s=$(e);s.find("#mobileFilterContent").append(n);var d=$("#popupContainer");s.find(".secondaryButton").on("click",function(){d.foundation("reveal","close")});s.find(".primaryButton").on("click",function(){g()});d.html(s);d.addClass("mobilePopupContainer");d.foundation("reveal","open");if(r===true){$(".mobileFilterPopup").addClass("ColorFilterPopup")}if(a=="size"){d.find("#mobileFilterContent").addClass("sizeContainer")}else{d.find("#mobileFilterContent").removeClass("sizeContainer")}};var g=function(){var e;$("#popupContainer").find("input").each(function(){var t=$(this);e=t.data("oldid");if(t.data("color")){if(t[0].checked){$("#"+e).attr("checked","checked")}else{$("#"+e).removeAttr("checked")}}else if(t.is('input[type="text"]')){$("#"+e).val(t.val())}else{var i="."+e.replace("facet-","facetContainer-");if(t[0].checked){$(i).children("input").attr("checked","checked")}else{$(i).children("input").removeAttr("checked")}}});$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")};var u=function(){if($("#mobileFilters").find(".mobileFilter").length===0){var e=$('<div class="desktopFilterContainer"></div>');var i=$('<div class="mobileFilterContainer"></div>');var a=0;var r=0;var l=0;var o=3;var d=3;var g;$(".filterHeader").each(function(){if(a>s.filterCount){return}var f=$(this);var u=f.data("filterid");if(typeof u==="undefined"||u==="category"){return}if(a==o){l++}if(c){var h="";if(a>d){h=" noStock hidden"}var v=f.html();if($(this).find("a").length>0){v=$(this).find("a").first().html()}g=$('<div id="'+u+'_Container" class="topFilterContainer'+h+'"><div data-filterid="'+u+'" id="'+u+'_FilterButton" class="mobileFilter"><a>'+v+'</a></div><div class="distanceBuffer"></div>'+y(u,r,l)+"</div>");t=u;n.push("#"+u+"_FilterButton")}$filterToggle=$('<div data-filterid="'+u+'" class="mobileFilter"><a>'+f.html()+"</a></div>");if($filterToggle.children("a").length>1){$filterToggle.children("a").first().hide()}$filterToggle.children("a").on("click",p);i.append($filterToggle);e.append(g);if(a==d&&c){var F='<div class="mobileFilter moreFilter"><a id="moreFilterBtn">'+labels.topfilterMore+"</a></div>";e.append(F)}a++;r++;if(r==4){r=0;l++}});$desktopSort=$('<div class="mobileFilter select"><div class="selectContainer"></div></div>');$desktopSort.find(".selectContainer").html($(".sortSelectContainer").html());$desktopSort.find("select").children().first().html(labels.mobileSort);$sort=$('<div class="mobileFilter select"><div class="selectContainer"></div></div>');$sort.find(".selectContainer").html($(".sortSelectContainer").html());$sort.find("select").children().first().html(labels.mobileSort);i.append($sort);$("#mobileFilters").append(i);if(c){e.append($desktopSort);$("#desktopFilters").append(e);$(".desktopFilterContainer").ifExists(function(){var e=this;if(a===5){e.find(".moreFilter").addClass("hidden");e.find(".topFilterContainer").removeClass("hidden");e.find(".topFilterContainer:nth-child(6)").addClass("restrictPosition")}else if(a===4){e.find(".moreFilter").addClass("hidden")}});f.init()}I()}};var h=function(e){F();$(".desktopFilterContainer").find(".noStock").each(function(){if($(this).css("display")=="none"){$(this).removeClass("hidden");$(".moreFilter").addClass("open")}else{$(this).addClass("hidden");$(".moreFilter").removeClass("open")}});if($("#moreFilterBtn").html()==labels.topfilterMore){$("#moreFilterBtn").html(labels.topfilterLess)}else{$("#moreFilterBtn").html(labels.topfilterMore)}};var v=function(){var e=$("#desktopFilters");e.find("input").parent().on("click",d)};var F=function(){$("#desktopFilters").find(".openedFilter").removeClass("openedFilter");$("#desktopFilters").find(".open").removeClass("open")};var m=function(e){var t=$("#topFilter_"+$(e.target).parent().data("filterid"));if(t.hasClass("openedFilter")){t.removeClass("openedFilter");t.parent().removeClass("open")}else{F();t.addClass("openedFilter");t.parent().addClass("open");if($(e.target).parent().data("filterid")=="price"){var i=$("<div></div>");i.html($("#priceFilterContainerDesktop").clone(false));i.find(".slider").html("")}}};var C=function(){if($("#mobileFilterCategory").hasClass("active")){B()}var e=$("#mobileFilters");if(!e.data("initialized")){u();e.data("initialized",true)}if(e.data("active")){e.data("active",false);$("#mobileCategoryGridHeader").removeClass("mobileFiltersOn")}else{e.data("active",true);$("#mobileCategoryGridHeader").addClass("mobileFiltersOn")}};var y=function(e,t,i){var a="";var r="";if(t===0){a="first"}if(t===3){a="last"}if(e=="price"){r='id = "priceFilterContainerDesktop"'}var l=$(".sideNavFilterContainer").find("#"+e+"FilterContainer").html();var o=$(".sideNavFilterContainer").find(".applyButton").html();return'<div id="topFilter_'+e+'"class="topFilterBox '+a+'"><div '+r+' class="filterContent">'+l+'</div><div class="applyButton primaryButton" style="cursor:pointer;">'+o+"</div>"+'<div class="closeTopFilterButton secondaryButton" style="cursor:pointer;"><span>'+labels.topfilterCloseButton+"</span></div>"+"</div>"};var b=function(e,t){if(typeof e==="undefined"){return null}if(typeof t==="undefined"){t="<ul></ul>"}if(e.length===0){$("#mobileFilterCategory").hide();return null}var i=$(t);for(var a=0;a<e.length;a++){var r=e[a];var l=$("<li></li>");if(kmo_wcs_pb$.getCategoryId()==r.id){l.addClass("selected");if(s.hideCategoryFilterInLeaf){$("#mobileFilterCategory").addClass("hidden")}}l.html('<a href="'+r.url+'"><span class="title">'+r.title+"</span></a>");i.append(l)}return i};var k=function(e,t){if(e.id==t){return e}else{if(typeof e.categories!=="undefined"){for(var i=0;i<e.categories.length;i++){var a=k(e.categories[i],t);if(a!==null){return a}}}}return null};var w=function(){var e=$("#mobileFilterCategory");if($("body").hasClass("bodyCategoryPage")){var t=null;if(typeof categoryNavData.lastLevel!=="undefined"){t=b(categoryNavData.lastLevel)}else{for(var i=0;i<topCategoryIds.length;i++){var a=k(categoryNavData[topCategoryIds[i]],kmo_wcs_pb$.getCategoryId());if(a!==null){t=b(a.categories);break}}}if(t===null){e.addClass("hidden")}else{e.append(t)}}else{if(s.hideCategoryFilterInLeaf&&$("#mobileSearchFilterCategory").find("ul").children().length===0){e.addClass("hidden")}e.append($("#mobileSearchFilterCategory").html())}};var B=function(){if($("#mobileCategoryGridHeader").hasClass("mobileFiltersOn")){C()}var e=$("#mobileFilterCategory");if(!e.data("initialized")){w();e.data("initialized",true)}if(e.data("active")){e.data("active",false);e.removeClass("active")}else{e.data("active",true);e.addClass("active")}};var _=function(){var e='<div class="mobileFilter selected"></div>';var t=false;var a=false;for(i=0;i<facetIDs.length;i++){var r=$("#available-"+facetIDs[i]+"-filters").find("input:checked");if(facetIDs[i]==="brand"){$("#additional-"+facetIDs[i]+"s").find("input:checked").each(function(){r.push($(this))})}if(facetIDs[i]==="price"){if($(".priceRangeTo").val()!=priceFilterMaxDefault||$(".priceRangeFrom").val()!=priceFilterMinDefault){a=true}}if(r.length>0){t=true}if(facetIDs[i]==="color"){r.each(function(){var t=$(this);var i=t.attr("id");var a="";var r=$(e);var l=$("<a></a>");l.on("click",function(){$("#"+i).parent().parent().click();$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")});$(".sideNavFilterContainer").find("div").each(function(){if($(this).attr("data-filterid")=="color"){a=$(this).html()}});l.append(a.trim()+": "+t.parent().parent().attr("title"));r.append(l);$("#mobileSelectedFilters").append(r)})}else{r.each(function(){var t=$(this);var i=t.attr("id");var a=$(e);var r=$("<a></a>");r.on("click",function(){$("#"+i).click();$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")});r.append(t.parent().find("label").html());a.append(r);$("#mobileSelectedFilters").append(a)})}}if(t){docCookies.setItem("filterStatus","active");$(".mobileSelectedFiltersContainer").addClass("hasFilter")}else{if(a!==true){docCookies.setItem("filterStatus","inactive")}}};function I(){var e=[];$("#mobileSelectedFilters").find(".selected").each(function(t){if($(this).find(".facetTitle").length>0){e[t]=$(this).find(".facetTitle").html().split(":")[0].trim()}else{e[t]=$(this).find("a").first().html().split(":")[0].trim()}});T($(".mobileFilterContainer"),e);T($(".desktopFilterContainer"),e);S()}function S(){$("#allSelectedFilters").find("input").each(function(){var e=$(this).attr("data-filterid");var t=$(this).attr("data-filtertype");$(this).parent().on("click",function(){catalog.removeFacetDesktopFilter(t,e,false)})})}function T(e,t){for(var i=0;i<t.length;i++){e.find(".mobileFilter").each(function(){for(var e=0;e<$(this).find("a").length;e++){if($(this).find("a")[e].innerHTML.trim()!==undefined){var a=$(this).find("a")[e].innerHTML.trim();if(t[i]==a){$(this).addClass("activeFilter")}}}})}}var L=function(){$("#allSelectedFilters").find('input[type="checkbox"]').each(function(){if(!$(this).is(":checked")){if(c){catalog.removeFacet($(this).data("filtertype"),$(this).data("filterid"),false)}else{catalog.removeFacet($(this).data("filtertype"),$(this).data("filterid"),true)}}});return false};var x=function(){$("#categoryFacetForm").off("change").on("change",function(){var e=$(this);var t;$("#categoryFacetForm").find(".applyButton").each(function(){$(this).hide()});$("#categoryFacetForm").find(".closeTopFilterButton").each(function(){$(this).show()});for(var i=0;i<formChanges($("#categoryFacetForm")[0]).length;i++){t=$("#"+formChanges($("#categoryFacetForm")[0])[i].id).parents(".filterContainer")[0].id;$("#"+t).find(".applyButton").show();$("#"+t).find(".closeTopFilterButton").hide()}if(!e.is(":checked")){catalog.removeFacet(e.data("filtertype"),e.data("filterid"),false)}if(c){if(o===$("#categoryFacetForm").serialize()){
$("#desktopFilters").find(".applyButton").hide();$("#desktopFilters").find(".closeTopFilterButton").show()}if(o!==$("#categoryFacetForm").serialize()){$("#desktopFilters").find(".applyButton").show();$("#desktopFilters").find(".closeTopFilterButton").hide()}}});S()};var z=function(){for(var e=0;e<n.length;e++){$(n[e]).on("click",m)}};w();if(c){u()}$("#mobileFilterToggle").on("click",C);$("#mobileFilterCategory").on("click",B);$("#allSelectedFilters").on("click",L);x();$(kmo_wcs_pb$.eventBus).on("catalog.initialized",x);$(".applyButton").on("click",function(){if(c){f.syncBeforeSubmit()}$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")});$(".closeTopFilterButton").on("click",function(){if(c){F()}});_();if(docCookies.getItem("filterStatus")=="active"){C()}if(c){$("#moreFilterBtn").on("click",h);I();v();z();$("#desktopFilters").find("input").off("click");if(typeof catalog!="undefined"){f.initSlider()}else{$(kmo_wcs_pb$.eventBus).one("catalog.initialized",function(){f.initSlider()})}$("#desktopFilters").find(".primaryButton").hide();$("#desktopFilters").find(".secondaryButton").show()}return{initialChangeCount:formChanges($("#categoryFacetForm")[0]).length,toggleColorFacet:function(e){var t=$("#facet-checkbox"+e);var i=$(".facet-color"+e);if(t.is(":checked")){i.find("input").prop("checked",false);i.toggleClass("selected",false)}else{i.find("input").prop("checked",true);i.toggleClass("selected",true)}var a,r;if(c){a=$("#topFilter_color").find(".applyButton");r=$("#topFilter_color").find(".closeTopFilterButton")}else{a=$("#colorFilterContainer").find(".applyButton");r=$("#colorFilterContainer").find(".closeTopFilterButton")}if(formChanges($("#categoryFacetForm")[0]).length>mobileFilters.initialChangeCount){a.show();r.hide()}else{a.hide();r.show()}}}};if(kmo_wcs_pb$.getFilterLayout()==="MobileLight"||$("#topFilterFlag").length>0){window.mobileFilters=new e}});