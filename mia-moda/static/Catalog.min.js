var catalog={autoLoadCatEntries:false,currentRequest:null,facetHasChanged:false,browsingMode:"scroll",preloadOffset:700,isMoreJS:false,bareBones:false,usedAjaxUrls:[],$window:$(window),scrollEvent:function(){if(!catalog.autoLoadCatEntries){$("#loadingIndicator").ifExists(function(){if($("#loadingIndicator").offset()){if(catalog.bareBones){if($(".productBox.bareBones").length>1){var e=catalog.preloadOffset+200;var t=catalog.$window.height();var a=catalog.$window.scrollTop();if($(".productBox.bareBones").length>0){var i=$(".productBox.bareBones").first().offset().top;var l=t+a;var o=catalog.preloadOffset+300;if(i-e<=l){catalog.lazyLoad(true)}}}}else if(catalog.$window.scrollTop()+catalog.$window.height()+catalog.preloadOffset>=$("#loadingIndicator").offset().top){catalog.lazyLoad()}}})}$("#catalogEntryGrid").ifExists(function(){var e=$("#catalogEntryGrid").offset().top+3*$(".productBoxContainer").height()-catalog.$window.height();if(window.matchMedia("(max-width: 766px)").matches&&$("#backToTopContainer").offset().top>=getTop()){e=getTop()}if(catalog.$window.scrollTop()>e){$("#backToTopContainer:hidden").fadeIn(200)}})},toggleFacet:function(e,t,a,i){if(a){this.appendFacet(e,t,i)}else{this.removeFacet(e,t,i)}},addFacets:function(e,t){$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},toggleColorFacet:function(e,t,a){var i=getElementByEvent(a);var l=false;var o=$("#facet-checkbox"+e);if(o.prop("checked")){o.prop("checked",false);$("#facet-color"+e).toggleClass("selected",false);var r=$(".facet-color"+e);r.find("input").prop("checked",false);r.toggleClass("selected",false)}else{o.prop("checked",true);$("#facet-color"+e).toggleClass("selected",true)}if(typeof i!=="undefined"){l=i.className.indexOf("colorName")>=0}if(t!="HappySizeMore"||t=="HappySizeMore"&&l){$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")}},toggleTileClass:function(e){$filter=$("#available-size-filters .facetContainer-size"+e);$inputInAvailableFilters=$filter.children("#facet-size"+e);$filterInSelection=$(".facetContainer-size"+e);$inputInSelectedFilters=$filterInSelection.children("#facet-size"+e);if($filter.hasClass("selected")){$inputInAvailableFilters.prop("checked",false);$inputInSelectedFilters.prop("checked",false);$filter.removeClass("selected")}else{$inputInAvailableFilters.prop("checked",$inputInAvailableFilters.prop("checked")==true?false:true);$inputInSelectedFilters.prop("checked",$inputInSelectedFilters.prop("checked")==true?false:true);$filter.toggleClass("marked")}},setCategoryFacet:function(e){$("#categoryFilterValue").val(e);$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},priceFacet:function(){$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},priceRangeFacet:function(e,t){var a=$("."+t).attr("name");var i=$("."+t).val();$(e).addClass("selected");var l=$("#"+t+"-min");var o=$("#"+t+"-max");var r=$("#priceRangeFrom");var n=$("#priceRangeTo");if(l.length>0&&r.length>0){r.val(l.val())}if(o.length>0&&n.length>0){n.val(o.val())}},clearPriceRange:function(e,t){t=t||window.event;var a=$(e);if(a.children("#onlySaleCheckbox-selected").length>0){$("#onlySaleCheckbox").attr("checked",false);$("#onlySaleCheckbox-selected").attr("checked",false)}else{var i=$("#priceRangeFrom");var l=$("#priceRangeTo");$("#priceRangeFrom").val("");$("#priceRangeTo").val("")}$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},appendFacet:function(e,t){$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},removeFacet:function(e,t,a){if(typeof a==="undefined"){a=true}$("#available-"+e+"-filters .facetContainer-"+e+t).parent().removeClass("selected");$(".selected-"+e+"-filters .facetContainer-"+e+t).remove();$("#available-"+e+"-filters #facet-"+e+t).prop("checked",false);if(a){$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")}},removeFacetHappySizeMore:function(e,t,a){var i=$(getElementByEvent(a));var l=i.parent().parent().hasClass("selectedFilterContainer");var o=i.parent().parent();if(l){$("#available-"+e+"-filters .facetContainer-"+e+t).parent().removeClass("selected");$(".selected-"+e+"-filters .facetContainer-"+e+t).remove();$("#available-"+e+"-filters #facet-"+e+t).prop("checked",false);$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")}else if($("html").hasClass("lt-ie9")){this.toggleTileClass(t)}},clearFilter:function(e){if(!$("#available-"+e+"-filters input:checked").length)return;$("#available-"+e+"-filters input").prop("checked",false);$(".selected-"+e+"-filters").html("");$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},clearColorFilter:function(e){if(!$("#available-color-filters input:checked").length)return;$("#available-color-filters input").prop("checked",false);$("#available-color-filters .color").toggleClass("selected",false);$(".selected-color-filters input").prop("checked",false);$(".selected-color-filters .color").toggleClass("selected",false);if(e)$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},clearCategoryFilter:function(){$("#categoryFilterValue").val("");$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},clearAllFilters:function(){this.clearAllFiltersOnly();$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")},clearAllFiltersOnly:function(){this.clearColorFilter(false);$(".selectedFiltersContainer").html("");$(".facetCheckbox").prop("checked",false);$("#priceRangeFrom").val(priceFilterMinDefault);$("#priceRangeTo").val(priceFilterMaxDefault);$("#priceFilterContainer input").each(function(){if($(this).is(":radio")||$(this).is(":checkbox")){$(this).removeAttr("checked")}})},updateFilters:function(){for(i=0;i<facetIDs.length;i++){if(facetIDs[i]==="color"){var e=$("#available-"+facetIDs[i]+"-filters input:checked").parent().parent().parent().clone();e.find("input").attr("name","");e.appendTo(".selected-"+facetIDs[i]+"-filters")}else{var t=$("#available-"+facetIDs[i]+"-filters input:checked");var a=$(".selected-"+facetIDs[i]+"-filters");$clone=t.parent().clone();$clone.find("input").attr("name","");a.html($clone);if((t.is(":radio")||t.is(":checkbox"))&&facetIDs[i]==="price"){a.children("div").addClass("selected");a.children("div").attr("onclick","catalog.clearPriceRange(this, event);");a.children().children("label").each(function(){$(this).attr("for",$(this).attr("for")+"-selected")});a.children().children("input").each(function(){var e=$(this).attr("id");var t=$(this).attr("name");if(e!==undefined){$(this).attr("id",$(this).attr("id")+"-selected")}if(t!==undefined&&t!==""){$(this).attr("name",$(this).attr("name")+"-selected")}else{$(this).attr("name",$(this).attr("id"))}});if(t.is(":radio")){t.attr("checked","true")}}}}},facetChanged:function(){if(typeof catalog.currentRequest!=="undefined"&&catalog.currentRequest){catalog.currentRequest.abort()}catalogAjaxURL=null;$("#catalogEntryGrid").html("");showLoadIndicator();catalog.checkFacetLabels();$("#categoryFacetForm").submit()},checkFacetLabels:function(){filterActive=false;for(i=0;i<facetIDs.length;i++){selectedFilters=$(".selected-"+facetIDs[i]+"-filters");if(selectedFilters.length&&selectedFilters.html().length){filterActive=true;$("#"+facetIDs[i]+"-filter-label").show()}else{$("#"+facetIDs[i]+"-filter-label").hide()}}if(filterActive){$("#allSelectedFiltersHeader").show()}else{$("#allSelectedFiltersHeader").hide()}$(".filterContainer").each(function(e,t){if($(t).children(".selectedFiltersContainer").find("div").length>=1){$(t).find(".selectedFilterLabel").show()}else{$(t).find(".selectedFilterLabel").hide()}})},lazyLoad:function(e){var e=e?e:false;if(!$.active){if(typeof catalogAjaxURL!=="undefined"&&catalogAjaxURL){if(e){var t=this.getPreparedCatalogAjaxUrl(catalogAjaxURL);if(catalog.usedAjaxUrls.indexOf(t)<0){this.loadCategoryEntries(t,true)}}else{var t=this.getPreparedCatalogAjaxUrl(catalogAjaxURL);if(catalog.browsingMode==="scroll"){$("#footer").css("visibility","hidden");$("#historyRecoTop").css("visibility","hidden")}this.loadCategory(t,true)}}else{hideLoadIndicator("catalogLoadingIndicator");$("#footer").css("visibility","visible");$("#historyRecoTop").css("visibility","visible");updateBackToTop()}}},imgLazyLoad:function(){$("img.lazyLoad").lazyload({threshold:150,effect:"fadeIn"})},getPreparedCatalogAjaxUrl:function(e){var t=new Url(e);if(typeof t.query.initPageSize!=="undefined"){t.query.beginIndex=t.query.pageSize;t.query.pageSize=t.query.initPageSize}return t.toString()},loadCategory:function(e,t){if(typeof this.currentRequest!="undefined"&&this.currentRequest){this.currentRequest.abort()}e=stripProtocol(e);if(!t&&catalog.browsingMode=="scroll"){$("#catalogEntryGrid").html("");showLoadIndicator("catalogLoadingIndicator")}this.currentRequest=$.post(e,function(e){$(e).appendTo("#catalogEntryGrid");catalog.imgLazyLoad();if(checkDevice.isMobile()){catalog.applyTouchFunctions()}if(this.autoLoadCatEntries){this.lazyLoad()}else{catalog.$window.scroll();updateBackToTop()}$(kmo_wcs_pb$.eventBus).trigger("catalog.loaded");hideLoadIndicator("catalogLoadingIndicator")}).always(function(){if(catalog.isMoreJS&&typeof MoreJS.showMoreColors=="function"){MoreJS.showMoreColors()}})},loadCategoryEntries:function(e,t){if(typeof this.currentRequest!="undefined"&&this.currentRequest){this.currentRequest.abort()}e=stripProtocol(e);this.currentRequest=$.post(e,function(t){catalog.usedAjaxUrls.push(e);var a=$(t);a.each(function(){var e=$(this);if(e.hasClass("productBoxContainer")){var t=e.prop("id");if(typeof t!=="undefined"){$("#"+t).empty().append(e.html())}}else if(e.attr("id")==="CatalogAjaxURL"){var a=e.data("url");if(catalog.usedAjaxUrls.indexOf(a)<0){catalogAjaxURL=a}}else if(e.prop("tagName")==="SCRIPT"){e.appendTo($("body"))}});$(kmo_wcs_pb$.eventBus).trigger("catalog.loaded");catalog.imgLazyLoad()}).always(function(){if(catalog.isMoreJS&&typeof MoreJS.showMoreColors=="function"){MoreJS.showMoreColors()}})},loadMoreCategoryEntries:function(){showLoadIndicator("catalogLoadingIndicator");$(".loadMoreCatEntriesContainer").addClass("hideBanner");catalog.lazyLoad()},filterSlideToggle:function(e){e.prev().children(".filterHeader").toggleClass("closed");e.toggleClass("closed")},toggleStandardFilter:function(){if($("#additionalFilterContainer").hasClass("closed")){$(".allAdditionalFiltersToggle .lessFilterLabel").css("display","none");$(".allAdditionalFiltersToggle .moreFiltersLabel").css("display","block");docCookies.setItem("filterCookieMore",0)}else{$(".allAdditionalFiltersToggle .lessFilterLabel").css("display","block");$(".allAdditionalFiltersToggle .moreFiltersLabel").css("display","none");docCookies.setItem("filterCookieMore",1)}if(window.matchMedia("(max-width: 1023px)").matches){$("#categoryFacetForm > .filterHeaderContainer").toggleClass("show");if($("#categoryFacetForm > .filterHeaderContainer")[0]!=null){$($("#categoryFacetForm > .filterHeaderContainer")[0]).addClass("firstFilter")}}},hoverColor:function(e,t){var a=$("#productSizes-"+e);var i=$("#productBox-"+e);i.addClass("hasHover");i.find(".categoryAvailabilityHover, .categoryProductAttributeContainer").off("mouseleave").on("mouseleave",function(){i.removeClass("hasHover");i.find(".categoryAvailabilityHover,  .categoryProductColors").off("mouseleave")});if(a.data("color")===t){return}else{$("#productSizes-"+e).html('<div class="loadingIndicator"><img src="'+kmo_wcs_pb$.getImgDir()+'ajax-loader.gif" alt="'+labels.loadingIconAlt+'"></div>');var l={};l.storeId=kmo_wcs_pb$.getStoreId();l.langId=kmo_wcs_pb$.getLangId();l.catalogId=kmo_wcs_pb$.getCatalogId();l.productId=e;l.colorId=t;if(typeof kmo_wcs_pb$.getCategoryId!="undefined"){l.categoryId=kmo_wcs_pb$.getCategoryId()}l.onlyCatalogEntryPrice="true";$.post("AjaxProductSizes",l,function(e){a.html(e);a.data("color",t);a.parents(".categoryAvailabilityHover").hide().show(0);a.parents(".categoryAvailabilityHover").attr("style","")})}},toggleColorBlock:function(e){$(e).parents(".categoryProductAttributeContainer").children(".categoryProductColors").removeClass("colorsOverflow");$(e).parents(".linkForColorOverflow").hide()},togglefilterexpanded:function(e){var t=$("#additional-"+e);t.toggle();if(t.parent().find(".expand").hasClass("not")){t.parent().find(".unexpand").addClass("not");t.parent().find(".expand").removeClass("not")}else if(t.parent().find(".unexpand").hasClass("not")){t.parent().find(".expand").addClass("not");t.parent().find(".unexpand").removeClass("not")}},initializeSlider:function(e){if(typeof e==="undefined"){e="#priceFilterContainer"}var t=$(e);if(!t.find("#priceFilter").length){return}var a=t.find(".priceRangeFrom");var i=t.find(".priceRangeTo");var l=a.val();if(!(l&&l!="*"))l=priceFilterMinDefault;var o=i.val();if(!(o&&o!="*"))o=priceFilterMaxDefault;return t.children(".slider").noUiSlider({range:[priceFilterMinDefault,priceFilterMaxDefault],start:[l,o],connect:true,serialization:{to:[a,i],resolution:1,mark:","}})},orderBy:function(e,t){$("#"+e+" [name='orderBy']").val(t);catalog.facetChanged()},synchronizeCatalogEspots:function(){$(".catalogListingESpot").each(function(){var e=$(this);$("#placeForEspotOnCategoryPage_"+e.data("index")).appendTo(e)})},applyTouchFunctions:function(){$("#catalogEntryGrid").find(".quickViewLink").css("display","none");$(".productBoxImage").off("touchend").on("touchend",function(){$(this).children(".catEntryDisplayLink").trigger("click")})},defineEvents:function(){var e="";var t=$("#categoryFacetForm");$links=t.find("a[data-click]");$links.each(function(){var t=$(this);t.click(function(a){var i=t.attr("data-click").split(";");for(var l=0;l<i.length;l++){var o=$.trim(i[l]);if(o.length>0){e=i[l];var r=new Function(e);try{r()}catch(n){if(window.console){console.log(n)}}}}})})}};function initializeCategoryPage(){catalog.isMoreJS=typeof MoreJS!="undefined";catalog.bareBones=function(){if(typeof kmo_wcs_pb$.getBareBones!=="undefined"&&kmo_wcs_pb$.getBareBones()===true){return true}else{return false}}();if(catalog.isMoreJS){catalog.browsingMode="click";hideLoadIndicator("catalogLoadingIndicator")}if($(".productBox").length&&catalog.browsingMode=="scroll"){if(!catalog.bareBones){$("#footer").css("visibility","hidden");$("#historyRecoTop").css("visibility","hidden")}else{hideLoadIndicator("catalogLoadingIndicator")}}catalog.initializeSlider();if(catalog.browsingMode=="scroll"){catalog.$window.scroll(function(){catalog.scrollEvent();updateBackToTop()})}else{catalog.$window.scroll(updateBackToTop)}if(checkDevice.isMobile()){catalog.applyTouchFunctions()}catalog.$window.resize(updateBackToTop,"resize",100);catalog.imgLazyLoad();$("#available-color-filters .colorTile").bind({mouseleave:function(){$("#color-filter-preview").html("")},mouseenter:function(){$(this).clone().appendTo("#color-filter-preview");$("#color-filter-preview").append($(this).children(".color").attr("title"))}});if(catalog.autoLoadCatEntries){catalog.lazyLoad()}else{catalog.$window.scroll()}catalog.updateFilters();if($("#allSelectedFilters .selectedFilterContainer").children().length){$("#allSelectedFiltersHeader").show()}else{$("#allSelectedFiltersHeader").hide()}catalog.checkFacetLabels();$("#mainContent").on("appear","img.lazyLoad",function(){$(this).removeClass("lazyLoad")});if(!catalog.isMoreJS&&kmo_wcs_pb$.getFilterLayout()!=="MobileLight"&&$(".catalogSection .categoryGridHeaderContainer").length>0){$("body").off("click",".sideNavFilterContainer  .filterInputContainer").on("click",".sideNavFilterContainer .filterInputContainer",function(){$("html, body").animate({scrollTop:$(".catalogSection .categoryGridHeaderContainer").offset().top+"px"},500)});catalog.scrollEvent()}if($("#additionalFilterContainer").length>0){$("#additionalFilterContainer").find(".filterContainer").each(function(){$(this).addClass("closed")})}var e=$("#priceFilterContainer");if(e.length>0){var t=$("#priceRangeFrom");var a=$("#priceRangeTo");if(t.length>0){t.bind("keyup",function(){MoreJS.toggleFilterBtn("#"+e.attr("id"))})}if(a.length>0){a.bind("keyup",function(){MoreJS.toggleFilterBtn("#"+e.attr("id"))})}}catalog.defineEvents();catalog.synchronizeCatalogEspots();$(kmo_wcs_pb$.eventBus).on("catalog.loaded",catalog.synchronizeCatalogEspots);$(kmo_wcs_pb$.eventBus).on("catalog.facetChanged",catalog.facetChanged);$(kmo_wcs_pb$.eventBus).trigger("catalog.initialized")}$(document).safeReady(initializeCategoryPage);$(document).safeReady(function(){var e=function(){var e='<div class="mobileFilterPopup">'+"<div id=\"mobileFilterCloseButton\" onclick=\"$('.mobileFilterPopup').foundation('reveal', 'close');\"></div>"+'<div id="mobileFilterContent"></div>'+'<div class="secondaryButton"><div class="buttonText">'+labels.mobileFilterClose+"</div></div>"+'<div class="primaryButton"><div class="buttonText">'+labels.mobileFilterApply+"</div></div>"+"</div>";var t={filterCount:7,hideCategoryFilterInLeaf:true};var a=function(t){var a=function(){var e=true;var t=$(".mobileFilterPopup").find(".primaryButton");var a=$(".mobileFilterPopup").find(".secondaryButton");$(".mobileFilterPopup").addClass("filterChanged");if(i.data("filterid")!="price"){var l;if(i.data("filterid")=="color")l=$(".mobileFilterPopup").find(".colorTile");else l=$(".mobileFilterPopup").find(".filterInputContainer");l.each(function(){var t=$(this).find("label").first();if($(this).find("input").first().is(":checked")){e=false;t.addClass("activeFilterItem");t.removeClass("inActiveFilterItem")}else{t.addClass("inActiveFilterItem");t.removeClass("activeFilterItem")}});if(e){t.hide();a.show()}else{a.hide();t.show()}}};var i=$(t.target).parent();var o=i.data("filterid");var r=false;var n=$("#"+o+"FilterContainer");var c;if(o==="size"){c=$("<div></div>");c.html(n.find("#visible-sizes").html()+n.find("#additional-sizes").html())}else if(o==="price"){c=$("<div></div>");c.html($("#priceFilterContainer").clone(false));c.find(".slider").html("");var s=catalog.initializeSlider(c.children());s.on("change",a)}else if(o==="color"){r=true;c=$("#available-color-filters").clone();c.find(".color").attr("onclick",null).off("click").on("click",function(){var e=$(this);var t=e.find("input");if(t.is(":checked")){e.addClass("selected")}else{e.removeClass("selected")}t.trigger("click");$("#"+t.data("oldid")).attr("checked",t.is(":checked"))});c.find("input").data("color",true)}else if(o==="brand"){c=$("#available-brand-filters").clone()}else{c=n.find(".availableFilters").clone()}c.find("input").each(function(){var e=$(this);e.off("change").on("change",a);e.data("oldid",e.attr("id"));var t=e.attr("id")+"mobile";e.attr("id",t);e.parent().children("label").attr("for",t)});var d=$(e);d.find("#mobileFilterContent").append(c);d.find(".secondaryButton").on("click",function(){$("#popupContainer").foundation("reveal","close")});d.find(".primaryButton").on("click",function(){l()});$("#popupContainer").html(d);$("#popupContainer").foundation("reveal","open");if(r==true){$(".mobileFilterPopup").addClass("ColorFilterPopup")}};var l=function(){var e;$("#popupContainer").find("input").each(function(){var t=$(this);e=t.data("oldid");if(t.data("color")){if(t[0].checked){$("#"+e).attr("checked","checked")}else{$("#"+e).removeAttr("checked")}}else if(t.is('input[type="text"]')){$("#"+e).val(t.val())}else{var a="."+e.replace("facet-","facetContainer-");if(t[0].checked){$(a).children("input").attr("checked","checked")}else{$(a).children("input").removeAttr("checked")}}});$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")};var o=function(){var e=$('<div class="mobileFilterContainer"></div>');var i=0;$(".filterHeader").each(function(){if(i>t.filterCount){return}i++;var l=$(this);var o=l.data("filterid");if(typeof o==="undefined"||o==="category"){return}$filterToggle=$('<div data-filterid="'+o+'" class="mobileFilter"><a>'+l.html()+"</a></div>");$filterToggle.children("a").on("click",a);e.append($filterToggle)});$sort=$('<div class="mobileFilter select"><div class="selectContainer"></div></div>');$sort.find(".selectContainer").html($(".sortSelectContainer").html());$sort.find("select").children().first().html(labels.mobileSort);e.append($sort);$("#mobileFilters").append(e);g()};var r=function(){if($("#mobileFilterCategory").hasClass("active")){d()}var e=$("#mobileFilters");if(!e.data("initialized")){o();e.data("initialized",true)}if(e.data("active")){e.data("active",false);$("#mobileCategoryGridHeader").removeClass("mobileFiltersOn")}else{e.data("active",true);$("#mobileCategoryGridHeader").addClass("mobileFiltersOn")}};var n=function(e,a){if(typeof e==="undefined"){return null}if(typeof a==="undefined"){a="<ul></ul>"}var i=$(a);for(var l=0;l<e.length;l++){var o=e[l];var r=$("<li></li>");if(kmo_wcs_pb$.getCategoryId()==o.id){r.addClass("selected");if(t.hideCategoryFilterInLeaf){$("#mobileFilterCategory").addClass("hidden")}}r.html('<a href="'+o.url+'"><span class="title">'+o.title+"</span></a>");i.append(r)}return i};var c=function(e,t){if(e.id==t){return e}else{if(typeof e.categories!=="undefined"){for(var a=0;a<e.categories.length;a++){var i=c(e.categories[a],t);if(i!==null){return i}}}}return null};var s=function(){var e=$("#mobileFilterCategory");if($("body").hasClass("bodyCategoryPage")){var a=null;if(typeof categoryNavData.lastLevel!=="undefined"){a=n(categoryNavData.lastLevel)}else{for(var i=0;i<topCategoryIds.length;i++){var l=c(categoryNavData[topCategoryIds[i]],kmo_wcs_pb$.getCategoryId());if(l!==null){a=n(l.categories);break}}}if(a==null){e.addClass("hidden")}else{}{e.append(a)}}else{if(t.hideCategoryFilterInLeaf&&$("#mobileSearchFilterCategory").find("ul").children().length===0){e.addClass("hidden")}e.append($("#mobileSearchFilterCategory").html())}};var d=function(){if($("#mobileCategoryGridHeader").hasClass("mobileFiltersOn")){r()}var e=$("#mobileFilterCategory");if(!e.data("initialized")){s();e.data("initialized",true)}if(e.data("active")){e.data("active",false);e.removeClass("active")}else{e.data("active",true);e.addClass("active")}};var f=function(){var e='<div class="mobileFilter selected"></div>';var t=false;var a=false;for(i=0;i<facetIDs.length;i++){var l=$("#available-"+facetIDs[i]+"-filters").find("input:checked");if(facetIDs[i]==="price"){if($(".priceRangeTo").val()!=priceFilterMaxDefault||$(".priceRangeFrom").val()!=priceFilterMinDefault){a=true}}if(l.length>0){t=true}if(facetIDs[i]==="color"){l.each(function(){var t=$(this);var a=t.attr("id");var i="";var l=$(e);var o=$("<a></a>");o.on("click",function(){$("#"+a).parent().parent().click();$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")});$(".sideNavFilterContainer").find("div").each(function(){if($(this).attr("data-filterid")=="color"){i=$(this).html()}});o.append(i.trim()+": "+t.parent().parent().attr("title"));l.append(o);$("#mobileSelectedFilters").append(l)})}else{l.each(function(){var t=$(this);var a=t.attr("id");var i=$(e);var l=$("<a></a>");l.on("click",function(){$("#"+a).click();$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")});l.append(t.parent().find("label").html());i.append(l);$("#mobileSelectedFilters").append(i)})}}if(t){docCookies.setItem("filterStatus","active");$(".mobileSelectedFiltersContainer").addClass("hasFilter")}else{if(a!=true){docCookies.setItem("filterStatus","inactive")}}};function g(){var e=[];var t=false;$("#mobileSelectedFilters").find(".selected").each(function(a){if($(this).find("span").first().html()!=undefined){e[a]=$(this).find("span").first().html().replace(":&nbsp;","")}else{t=true}});for(var a=0;a<e.length;a++){$(".mobileFilterContainer").find(".mobileFilter").each(function(){if($(this).find("a").first().html()!=undefined){if(e[a]==$(this).find("a").first().html().trim()){$(this).find("a").first().css("color","#e85985");$(this).addClass("activeFilter")}if($(this).attr("data-filterid")=="color"&&t==true){$(this).find("a").first().css("color","#e85985");$(this).addClass("activeFilter")}}})}}var p=function(){$(".facetCheckbox").off("change").on("change",function(){var e=$(this);var t;$("#categoryFacetForm").find(".applyButton").each(function(){$(this).hide()});var a=e.data("filtertype");var i=e.data("filterid");if(e.is(":checked")){$(".facetContainer-"+a+i).parent().addClass("selected");$(".facet-"+a+i).prop("checked",true)}else{$(".facetContainer-"+a+i).parent().removeClass("selected");$(".facet-"+a+i).prop("checked",false)}var l=formChanges($("#categoryFacetForm")[0]);for(var o=0;o<l.length;o++){$("."+l[o].id).parents(".filterContainer").find(".applyButton").show()}if(l.length>0){var r=$("#allSelectedFilters").find(".applyButton").show()}})};s();$("#mobileFilterToggle").on("click",r);$("#mobileFilterCategory").on("click",d);p();$(kmo_wcs_pb$.eventBus).on("catalog.initialized",p);$(".applyButton").on("click",function(){$(kmo_wcs_pb$.eventBus).trigger("catalog.facetChanged")});f();if(docCookies.getItem("filterStatus")=="active"){r()}return{toggleColorFacet:function(e){var t=$("#facet-checkbox"+e);var a=$(".facet-color"+e);if(t.is(":checked")){a.find("input").prop("checked",false);a.toggleClass("selected",false)}else{a.find("input").prop("checked",true);a.toggleClass("selected",true)}var i=$("#colorFilterContainer").find(".applyButton");if(formChanges($("#categoryFacetForm")[0]).length>0){i.show()}else{i.hide()}}}};if(kmo_wcs_pb$.getFilterLayout()==="MobileLight"){window.mobileFilters=new e}});